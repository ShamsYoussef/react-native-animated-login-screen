{"version":3,"sources":["../../src/appleApi/provisioningProfileAdhoc.ts"],"names":["ProvisioningProfileAdhocManager","constructor","appleCtx","ctx","createOrReuse","udids","bundleIdentifier","distCertSerialNumber","spinner","start","args","appleId","appleIdPassword","team","id","join","adhocProvisioningProfile","travelingFastlane","manageAdHocProvisioningProfile","provisioningProfileUpdateTimestamp","provisioningProfileCreateTimestamp","provisioningProfileName","succeed"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;;;AAIO,MAAMA,+BAAN,CAAsC;AAE3CC,EAAAA,WAAW,CAACC,QAAD,EAAqB;AAAA;;AAC9B,SAAKC,GAAL,GAAWD,QAAX;AACD;;AAED,QAAME,aAAN,CACEC,KADF,EAEEC,gBAFF,EAGEC,oBAHF,EAIgC;AAC9B,UAAMC,OAAO,GAAG,oBACb,mEADa,EAEdC,KAFc,EAAhB;AAGA,UAAMC,IAAI,GAAG,CACX,YADW,EAEX,KAAKP,GAAL,CAASQ,OAFE,EAGX,kBAHW,EAIX,KAAKR,GAAL,CAASS,eAJE,EAKX,KAAKT,GAAL,CAASU,IAAT,CAAcC,EALH,EAMXT,KAAK,CAACU,IAAN,CAAW,GAAX,CANW,EAOXT,gBAPW,EAQXC,oBARW,CAAb;AAUA,UAAMS,wBAAwB,GAAG,MAAM,2BACrCC,8BAAkBC,8BADmB,EAErCR,IAFqC,CAAvC;AAKA,UAAM;AACJS,MAAAA,kCADI;AAEJC,MAAAA,kCAFI;AAGJC,MAAAA;AAHI,QAIFL,wBAJJ;;AAKA,QAAII,kCAAJ,EAAwC;AACtCZ,MAAAA,OAAO,CAACc,OAAR,CAAiB,wBAAuBD,uBAAwB,EAAhE;AACD,KAFD,MAEO,IAAIF,kCAAJ,EAAwC;AAC7CX,MAAAA,OAAO,CAACc,OAAR,CAAiB,6BAA4BD,uBAAwB,EAArE;AACD,KAFM,MAEA;AACLb,MAAAA,OAAO,CAACc,OAAR,CAAiB,0BAAyBD,uBAAwB,EAAlE;AACD;;AAED,WAAOL,wBAAwB,CAACG,kCAAhC;AACA,WAAOH,wBAAwB,CAACI,kCAAhC;AACA,WAAOJ,wBAAwB,CAACK,uBAAhC;AAEA,WAAOL,wBAAP;AACD;;AA/C0C","sourcesContent":["import ora from 'ora';\n\nimport { runAction, travelingFastlane } from './fastlane';\nimport { AppleCtx } from './authenticate';\nimport { ProvisioningProfile } from './provisioningProfile';\n\nexport class ProvisioningProfileAdhocManager {\n  ctx: AppleCtx;\n  constructor(appleCtx: AppleCtx) {\n    this.ctx = appleCtx;\n  }\n\n  async createOrReuse(\n    udids: string[],\n    bundleIdentifier: string,\n    distCertSerialNumber: string\n  ): Promise<ProvisioningProfile> {\n    const spinner = ora(\n      `Handling Adhoc provisioning profiles on Apple Developer Portal...`\n    ).start();\n    const args = [\n      '--apple-id',\n      this.ctx.appleId,\n      '--apple-password',\n      this.ctx.appleIdPassword,\n      this.ctx.team.id,\n      udids.join(','),\n      bundleIdentifier,\n      distCertSerialNumber,\n    ];\n    const adhocProvisioningProfile = await runAction(\n      travelingFastlane.manageAdHocProvisioningProfile,\n      args\n    );\n\n    const {\n      provisioningProfileUpdateTimestamp,\n      provisioningProfileCreateTimestamp,\n      provisioningProfileName,\n    } = adhocProvisioningProfile;\n    if (provisioningProfileCreateTimestamp) {\n      spinner.succeed(`Created new profile: ${provisioningProfileName}`);\n    } else if (provisioningProfileUpdateTimestamp) {\n      spinner.succeed(`Updated existing profile: ${provisioningProfileName}`);\n    } else {\n      spinner.succeed(`Used existing profile: ${provisioningProfileName}`);\n    }\n\n    delete adhocProvisioningProfile.provisioningProfileUpdateTimestamp;\n    delete adhocProvisioningProfile.provisioningProfileCreateTimestamp;\n    delete adhocProvisioningProfile.provisioningProfileName;\n\n    return adhocProvisioningProfile;\n  }\n}\n"],"file":"provisioningProfileAdhoc.js"}