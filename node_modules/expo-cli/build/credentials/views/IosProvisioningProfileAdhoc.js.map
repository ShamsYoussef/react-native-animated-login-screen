{"version":3,"sources":["../../../src/credentials/views/IosProvisioningProfileAdhoc.ts"],"names":["CreateOrReuseProvisioningProfileAdhoc","constructor","options","experienceName","bundleIdentifier","distCertSerialNumber","udids","_experienceName","_bundleIdentifier","_distCertSerialNumber","_udids","assignProvisioningProfile","ctx","provisioningProfile","ios","updateProvisioningProfile","appleCtx","team","chalk","green","provisioningProfileId","createOrReuse","ensureAppleCtx","ppManager","ProvisioningProfileAdhocManager","open","user","Error"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAGA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;;;AASO,MAAMA,qCAAN,CAA6D;AAMlEC,EAAAA,WAAW,CAACC,OAAD,EAA2C;AAAA;;AAAA;;AAAA;;AAAA;;AACpD,UAAM;AAAEC,MAAAA,cAAF;AAAkBC,MAAAA,gBAAlB;AAAoCC,MAAAA,oBAApC;AAA0DC,MAAAA;AAA1D,QAAoEJ,OAA1E;AACA,SAAKK,eAAL,GAAuBJ,cAAvB;AACA,SAAKK,iBAAL,GAAyBJ,gBAAzB;AACA,SAAKK,qBAAL,GAA6BJ,oBAA7B;AACA,SAAKK,MAAL,GAAcJ,KAAd;AACD;;AAED,QAAMK,yBAAN,CAAgCC,GAAhC,EAA8CC,mBAA9C,EAAwF;AACtF,UAAMD,GAAG,CAACE,GAAJ,CAAQC,yBAAR,CACJ,KAAKR,eADD,EAEJ,KAAKC,iBAFD,EAGJK,mBAHI,EAIJD,GAAG,CAACI,QAAJ,CAAaC,IAJT,CAAN;AAMA,wBACEC,iBAAMC,KAAN,CACG,kDAAiDN,mBAAmB,CAACO,qBAAsB,OAAM,KAAKb,eAAgB,KAAI,KAAKC,iBAAkB,GADpJ,CADF;AAKD;;AAED,QAAMa,aAAN,CAAoBT,GAApB,EAAgE;AAC9D,UAAMA,GAAG,CAACU,cAAJ,EAAN;AACA,UAAMC,SAAS,GAAG,KAAIC,2DAAJ,EAAoCZ,GAAG,CAACI,QAAxC,CAAlB;AACA,WAAO,MAAMO,SAAS,CAACF,aAAV,CACX,KAAKX,MADM,EAEX,KAAKF,iBAFM,EAGX,KAAKC,qBAHM,CAAb;AAKD;;AAED,QAAMgB,IAAN,CAAWb,GAAX,EAAgD;AAC9C,QAAI,CAACA,GAAG,CAACc,IAAT,EAAe;AACb,YAAM,IAAIC,KAAJ,CAAW,6CAAX,CAAN;AACD;;AAED,UAAMd,mBAAmB,GAAG,MAAM,KAAKQ,aAAL,CAAmBT,GAAnB,CAAlC;AACA,UAAM,KAAKD,yBAAL,CAA+BC,GAA/B,EAAoCC,mBAApC,CAAN;AACA,WAAO,IAAP;AACD;;AA9CiE","sourcesContent":["import chalk from 'chalk';\nimport { Context, IView } from '../context';\nimport { ProvisioningProfile } from '../../appleApi';\nimport { ProvisioningProfileAdhocManager } from '../../appleApi/provisioningProfileAdhoc';\nimport log from '../../log';\n\nexport type ProvisioningProfileAdhocOptions = {\n  experienceName: string;\n  bundleIdentifier: string;\n  distCertSerialNumber: string;\n  udids: string[];\n};\n\nexport class CreateOrReuseProvisioningProfileAdhoc implements IView {\n  _experienceName: string;\n  _bundleIdentifier: string;\n  _distCertSerialNumber: string;\n  _udids: string[];\n\n  constructor(options: ProvisioningProfileAdhocOptions) {\n    const { experienceName, bundleIdentifier, distCertSerialNumber, udids } = options;\n    this._experienceName = experienceName;\n    this._bundleIdentifier = bundleIdentifier;\n    this._distCertSerialNumber = distCertSerialNumber;\n    this._udids = udids;\n  }\n\n  async assignProvisioningProfile(ctx: Context, provisioningProfile: ProvisioningProfile) {\n    await ctx.ios.updateProvisioningProfile(\n      this._experienceName,\n      this._bundleIdentifier,\n      provisioningProfile,\n      ctx.appleCtx.team\n    );\n    log(\n      chalk.green(\n        `Successfully assigned Provisioning Profile id: ${provisioningProfile.provisioningProfileId} to ${this._experienceName} (${this._bundleIdentifier})`\n      )\n    );\n  }\n\n  async createOrReuse(ctx: Context): Promise<ProvisioningProfile> {\n    await ctx.ensureAppleCtx();\n    const ppManager = new ProvisioningProfileAdhocManager(ctx.appleCtx);\n    return await ppManager.createOrReuse(\n      this._udids,\n      this._bundleIdentifier,\n      this._distCertSerialNumber\n    );\n  }\n\n  async open(ctx: Context): Promise<IView | null> {\n    if (!ctx.user) {\n      throw new Error(`This workflow requires you to be logged in.`);\n    }\n\n    const provisioningProfile = await this.createOrReuse(ctx);\n    await this.assignProvisioningProfile(ctx, provisioningProfile);\n    return null;\n  }\n}\n"],"file":"IosProvisioningProfileAdhoc.js"}