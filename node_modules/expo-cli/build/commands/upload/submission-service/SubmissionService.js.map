{"version":3,"sources":["../../../../src/commands/upload/submission-service/SubmissionService.ts"],"names":["SubmissionService","startSubmissionAsync","getSubmissionAsync","DEFAULT_CHECK_INTERVAL_MS","platform","projectId","config","api","getApiClientForUser","submissionId","postAsync","result","getAsync","user","UserManager","ensureLoggedInAsync","ApiV2","clientForUser"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAUA,MAAMA,iBAAiB,GAAG;AACxBC,EAAAA,oBADwB;AAExBC,EAAAA;AAFwB,CAA1B;AAKA,MAAMC,yBAAyB,GAAG,IAAI,IAAtC,C,CAA4C;;;;AAE5C,eAAeF,oBAAf,CACEG,QADF,EAEEC,SAFF,EAGEC,MAHF,EAIkC;AAChC,QAAMC,GAAG,GAAG,MAAMC,mBAAmB,EAArC;AACA,QAAM;AAAEC,IAAAA;AAAF,MAAmB,MAAMF,GAAG,CAACG,SAAJ,CAAe,YAAWL,SAAU,wBAApC,EAA6D;AAC1FD,IAAAA,QAD0F;AAE1FE,IAAAA,MAAM,EAAGA;AAFiF,GAA7D,CAA/B;AAIA,SAAOG,YAAP;AACD;;AAED,eAAeP,kBAAf,CAAkCG,SAAlC,EAAqDI,YAArD,EAAgG;AAC9F,QAAMF,GAAG,GAAG,MAAMC,mBAAmB,EAArC;AACA,QAAMG,MAAkB,GAAG,MAAMJ,GAAG,CAACK,QAAJ,CAC9B,YAAWP,SAAU,0BAAyBI,YAAa,EAD7B,CAAjC;AAGA,SAAOE,MAAP;AACD;;AAED,eAAeH,mBAAf,GAAqD;AACnD,QAAMK,IAAI,GAAG,MAAMC,mBAAYC,mBAAZ,EAAnB;AACA,SAAOC,aAAMC,aAAN,CAAoBJ,IAApB,CAAP;AACD;;eAEcb,iB","sourcesContent":["import { ApiV2, UserManager } from '@expo/xdl';\nimport { JSONObject } from '@expo/json-file';\n\nimport {\n  Platform,\n  StartSubmissionResult,\n  Submission,\n  SubmissionConfig,\n} from './SubmissionService.types';\n\nconst SubmissionService = {\n  startSubmissionAsync,\n  getSubmissionAsync,\n};\n\nconst DEFAULT_CHECK_INTERVAL_MS = 5 * 1000; // 5 secs\n\nasync function startSubmissionAsync(\n  platform: Platform,\n  projectId: string,\n  config: SubmissionConfig\n): Promise<StartSubmissionResult> {\n  const api = await getApiClientForUser();\n  const { submissionId } = await api.postAsync(`projects/${projectId}/app-store-submissions`, {\n    platform,\n    config: (config as unknown) as JSONObject,\n  });\n  return submissionId;\n}\n\nasync function getSubmissionAsync(projectId: string, submissionId: string): Promise<Submission> {\n  const api = await getApiClientForUser();\n  const result: Submission = await api.getAsync(\n    `projects/${projectId}/app-store-submissions/${submissionId}`\n  );\n  return result;\n}\n\nasync function getApiClientForUser(): Promise<ApiV2> {\n  const user = await UserManager.ensureLoggedInAsync();\n  return ApiV2.clientForUser(user);\n}\n\nexport default SubmissionService;\nexport { DEFAULT_CHECK_INTERVAL_MS };\n"],"file":"SubmissionService.js"}