{"version":3,"sources":["../../src/commands/eject.ts"],"names":["userWantsToEjectWithoutUpgradingAsync","answer","type","name","message","ejectWithoutUpgrading","action","projectDir","options","exp","error","console","log","chalk","red","process","exit","Versions","lteSdkVersion","latestReleasedVersion","newestReleasedSdkVersionAsync","sdkVersion","version","LegacyEject","ejectAsync","force","Eject","program","command","description","option","value","toLowerCase","asyncActionProjectDir"],"mappings":";;;;;;;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAEA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;;;;;;;AAEA,eAAeA,qCAAf,GAAuD;AACrD,QAAMC,MAAM,GAAG,MAAM,uBAAO;AAC1BC,IAAAA,IAAI,EAAE,SADoB;AAE1BC,IAAAA,IAAI,EAAE,uBAFoB;AAG1BC,IAAAA,OAAO,EAAG;AAHgB,GAAP,CAArB;AAMA,SAAOH,MAAM,CAACI,qBAAd;AACD;;AAED,eAAeC,MAAf,CACEC,UADF,EAEEC,OAFF,EAGE;AACA,MAAIC,GAAJ;;AACA,MAAI;AACFA,IAAAA,GAAG,GAAG,yBAAUF,UAAV,EAAsBE,GAA5B;AACD,GAFD,CAEE,OAAOC,KAAP,EAAc;AACdC,IAAAA,OAAO,CAACC,GAAR;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAYC,iBAAMC,GAAN,CAAUJ,KAAK,CAACN,OAAhB,CAAZ;AACAO,IAAAA,OAAO,CAACC,GAAR;AACAG,IAAAA,OAAO,CAACC,IAAR,CAAa,CAAb;AACD,GATD,CAWA;;;AACA,MAAIC,gBAASC,aAAT,CAAuBT,GAAvB,EAA4B,QAA5B,CAAJ,EAA2C;AACzC;AACA,QAAIU,qBAAqB,GAAG,MAAMF,gBAASG,6BAAT,EAAlC;;AACA,QAAIH,gBAASC,aAAT,CAAuB;AAAEG,MAAAA,UAAU,EAAEF,qBAAqB,CAACG;AAApC,KAAvB,EAAsE,QAAtE,CAAJ,EAAqF;AACnF,YAAMC,WAAW,GAACC,UAAZ,CAAuBjB,UAAvB,EAAmCC,OAAnC,CAAN;AACD,KAFD,MAEO;AACL,UAAIA,OAAO,CAACiB,KAAR,KAAkB,MAAMzB,qCAAqC,EAA7D,CAAJ,EAAsE;AACpE,cAAMuB,WAAW,GAACC,UAAZ,CAAuBjB,UAAvB,EAAmCC,OAAnC,CAAN;AACD;AACF;AACF,GAVD,MAUO;AACL,UAAMkB,KAAK,GAACF,UAAN,CAAiBjB,UAAjB,EAA6BC,OAA7B,CAAN;AACD;AACF;;AAEc,kBAASmB,OAAT,EAA2B;AACxCA,EAAAA,OAAO,CACJC,OADH,CACW,qBADX,EAEGC,WAFH,CAGI,kHAHJ,EAKGC,MALH,CAMI,uBANJ,EAOK,2LAPL,EAQIC,KAAK,IAAIA,KAAK,CAACC,WAAN,EARb,EAUGF,MAVH,CAWI,YAXJ,EAYI,yGAZJ,EAcGG,qBAdH,CAcyB3B,MAdzB;AAeD","sourcesContent":["import chalk from 'chalk';\nimport { Command } from 'commander';\nimport { Versions } from '@expo/xdl';\nimport { ExpoConfig, getConfig } from '@expo/config';\nimport * as Eject from './eject/Eject';\nimport * as LegacyEject from './eject/LegacyEject';\nimport prompt from '../prompt';\n\nasync function userWantsToEjectWithoutUpgradingAsync() {\n  const answer = await prompt({\n    type: 'confirm',\n    name: 'ejectWithoutUpgrading',\n    message: `We recommend upgrading to the latest SDK version before ejecting. SDK 37 introduces support for OTA updates and notifications in ejected projects, and includes many features that make ejecting your project easier. Would you like to continue ejecting anyways?`,\n  });\n\n  return answer.ejectWithoutUpgrading;\n}\n\nasync function action(\n  projectDir: string,\n  options: LegacyEject.EjectAsyncOptions | Eject.EjectAsyncOptions\n) {\n  let exp: ExpoConfig;\n  try {\n    exp = getConfig(projectDir).exp;\n  } catch (error) {\n    console.log();\n    console.log(chalk.red(error.message));\n    console.log();\n    process.exit(1);\n  }\n\n  // Set EXPO_VIEW_DIR to universe/exponent to pull expo view code locally instead of from S3 for ExpoKit\n  if (Versions.lteSdkVersion(exp, '36.0.0')) {\n    // Don't show a warning if we haven't released SDK 37 yet\n    let latestReleasedVersion = await Versions.newestReleasedSdkVersionAsync();\n    if (Versions.lteSdkVersion({ sdkVersion: latestReleasedVersion.version }, '36.0.0')) {\n      await LegacyEject.ejectAsync(projectDir, options as LegacyEject.EjectAsyncOptions);\n    } else {\n      if (options.force || (await userWantsToEjectWithoutUpgradingAsync())) {\n        await LegacyEject.ejectAsync(projectDir, options as LegacyEject.EjectAsyncOptions);\n      }\n    }\n  } else {\n    await Eject.ejectAsync(projectDir, options as Eject.EjectAsyncOptions);\n  }\n}\n\nexport default function(program: Command) {\n  program\n    .command('eject [project-dir]')\n    .description(\n      'Creates Xcode and Android Studio projects for your app. Use this if you need to add custom native functionality.'\n    )\n    .option(\n      '--eject-method [type]',\n      `Eject method to use. [Depreacted]: Ejecting to ExpoKit is not available on SDK >= 37 and not recommended for older SDK versions. We recommend updating to SDK >= 37 and ejecting to bare.`,\n      value => value.toLowerCase()\n    )\n    .option(\n      '-f --force',\n      'Will attempt to generate an iOS project even when the system is not running macOS. Unsafe and may fail.'\n    )\n    .asyncActionProjectDir(action);\n}\n"],"file":"eject.js"}