{"version":3,"file":"project.js","sourceRoot":"","sources":["../../src/utils/project.ts"],"names":[],"mappings":";;;;;AAAA,gDAAwB;AAExB,kEAA4C;AAC5C,sEAAuC;AASvC,KAAK,UAAU,KAAK,CAAC,GAAoB;IACvC,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,GAAG,CAAC;IAE5B,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;IAC1D,MAAM,cAAc,GAAG,cAAI,CAAC,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE,gBAAgB,CAAC,CAAC;IAEnE,MAAM,CAAC,IAAI,CAAC,EAAE,UAAU,EAAE,GAAG,CAAC,UAAU,EAAE,EAAE,0BAA0B,CAAC,CAAC;IACxE,MAAM,oBAAY,CAAC,GAAG,CAAC,UAAU,EAAE,cAAc,CAAC,CAAC;IAEnD,MAAM,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;IACzC,MAAM,sBAAK,CACT,KAAK,EACL,CAAC,oBAAoB,EAAE,GAAG,EAAE,MAAM,EAAE,gBAAgB,EAAE,IAAI,EAAE,cAAc,CAAC,EAC3E,EAAE,GAAG,EAAE,GAAG,CAAC,UAAU,EAAE,MAAM,EAAE,CAChC,CAAC;IAEF,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;IAC5B,MAAM,sBAAK,CAAC,MAAM,EAAE,CAAC,SAAS,CAAC,EAAE,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,CAAC,CAAC;IAElE,OAAO,cAAc,CAAC;AACxB,CAAC;AAEQ,sBAAK","sourcesContent":["import path from 'path';\n\nimport downloadFile from '@expo/downloader';\nimport spawn from '@expo/turtle-spawn';\n\nimport { BuilderCtx } from '../context';\nimport { BaseAndroidJob } from '../platforms/android/baseJob';\nimport { BaseiOSJob } from '../platforms/ios/baseJob';\n\n\ntype Job = BaseAndroidJob | BaseiOSJob;\n\nasync function setup(ctx: BuilderCtx<Job>): Promise<string> {\n  const { job, logger } = ctx;\n\n  const buildDirectory = path.join(ctx.workingdir, 'build');\n  const projectTarball = path.join(ctx.workingdir, 'project.tar.gz');\n\n  logger.info({ projectUrl: job.projectUrl }, 'Download project archive');\n  await downloadFile(job.projectUrl, projectTarball);\n\n  logger.info('Unpacking project archive');\n  await spawn(\n    'tar',\n    ['--strip-components', '1', '-zxf', 'project.tar.gz', '-C', buildDirectory],\n    { cwd: ctx.workingdir, logger },\n  );\n\n  logger.info('Running yarn');\n  await spawn('yarn', ['install'], { cwd: buildDirectory, logger });\n\n  return buildDirectory;\n}\n\nexport { setup };\n"]}